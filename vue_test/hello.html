<!DOCTYPE html>
<head>
    <title>document</title>
    <style>
        .active {
            background-color: "#ff5d23";
        }
    </style>
</head>

<body>
    <div id="app">
        <h2 v-bind:title="title">
            {{title}}
        </h2>
        <span v-once :title="title1">{{title1}}</span> 
        <course-add :value="newCourse" @input="newCourse=$event" v-on:addcourse="addCourseHandle"></course-add>
        <p v-if="total == 0">没有任何课程</p>
        <course-list :courses="courseList"></course-list>
        <p>总共 {{totalCount}} 门课程</p>
    </div>

    <script src="vue.js"></script>
    <script>
        Vue.component('course-list', {
            data() {
                return {
                    selectCourse: "",
                }
            },
            props: {
                courses: {
                    type: Array,
                    default: []
                }
            },
            methods: {
                updatSelectCourse(current) {
                    this.selectCourse = current
                    console.log("-----", current)
                },
            },
            template: `
                <div v-else>
                    <ul v-for="item in courses" :key="item" v-bind:title="item">
                        <!-- <li :class="{active: selectCourse === item}" @click="updatSelectCourse(item)">{{item}}</li> -->
                        <li :style="{backgroundColor: selectCourse === item ? '#ff5d23' : 'transparent'}" @click=updatSelectCourse(item)>{{item}}</li>
                    </ul>
                </div>
            `
        })

        Vue.component ('course-add', {
            props: ['value'],
            methods: {
                addCourse() {
                    this.$emit('addcourse')
                },
                onInput(e) {
                    this.$emit('input', e.target.value)
                }
            },
            template: `
                <p>
                    <input type="text" :value="value" v-on:input=onInput v-on:keydown.enter="addCourse">
                    <button @click="addCourse">新增</button>
                </p>
            `
        })

        function getCourses() {
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve(["C++", "Java"]) 
                }, 2000);
            })
        }
        const app = new Vue({
            el: "#app",
            data: {
                title: "hello vue !!!",
                title1: "hello wo bu bian",
                courseList: [], //"c++", "java", "python"
                totalCount: 0,
                newCourse: ""
            },
            computed: {
                total() {
                    return this.courseList.length 
                }
            },
            methods: {
                addCourseHandle() {
                    if (this.newCourse == "") {
                        this.courseList = []
                    } else {
                        console.log("--addCourseHandle---", this.newCourse)
                        this.courseList.push(this.newCourse)
                        this.newCourse = ""
                    }
                },
            },
            watch: {
                courseList: {
                    immediate: true,
                    deep: true,
                    handler(newValue, oldValue) {
                        this.totalCount = newValue.length
                    }
                }
            },
            async created() {
                this.courseList = await getCourses()
            },
        })        

        setTimeout(() => {
            app.title = "嘿嘿嘿 ！！！" ,
            app.title = "wo yao bian"  
         }, 1000)
    </script>

</body>

</html>